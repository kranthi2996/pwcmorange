"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.formatAttachment = formatAttachment;
const messages_1 = require("@cucumber/messages");
const TextBuilder_1 = require("../TextBuilder");
function formatAttachment(attachment, theme, stream) {
    switch (attachment.contentEncoding) {
        case messages_1.AttachmentContentEncoding.BASE64:
            return formatBase64Attachment(attachment.body, attachment.mediaType, attachment.fileName, theme, stream);
        case messages_1.AttachmentContentEncoding.IDENTITY:
            return formatTextAttachment(attachment.body, theme, stream);
    }
}
function formatBase64Attachment(data, mediaType, fileName, theme, stream) {
    const builder = new TextBuilder_1.TextBuilder(stream);
    const bytes = (data.length / 4) * 3;
    if (fileName) {
        builder.append(`Embedding ${fileName} [${mediaType} ${bytes} bytes]`);
    }
    else {
        builder.append(`Embedding [${mediaType} ${bytes} bytes]`);
    }
    return builder.build(theme.attachment);
}
function formatTextAttachment(content, theme, stream) {
    return new TextBuilder_1.TextBuilder(stream).append(content).build(theme.attachment);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybWF0QXR0YWNobWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9mb3JtYXR0aW5nL2Zvcm1hdEF0dGFjaG1lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFLQSw0Q0FpQkM7QUF0QkQsaURBQTBFO0FBRTFFLGdEQUE0QztBQUc1QyxTQUFnQixnQkFBZ0IsQ0FDOUIsVUFBc0IsRUFDdEIsS0FBWSxFQUNaLE1BQTZCO0lBRTdCLFFBQVEsVUFBVSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ25DLEtBQUssb0NBQXlCLENBQUMsTUFBTTtZQUNuQyxPQUFPLHNCQUFzQixDQUMzQixVQUFVLENBQUMsSUFBSSxFQUNmLFVBQVUsQ0FBQyxTQUFTLEVBQ3BCLFVBQVUsQ0FBQyxRQUFRLEVBQ25CLEtBQUssRUFDTCxNQUFNLENBQ1AsQ0FBQTtRQUNILEtBQUssb0NBQXlCLENBQUMsUUFBUTtZQUNyQyxPQUFPLG9CQUFvQixDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFBO0lBQy9ELENBQUM7QUFDSCxDQUFDO0FBRUQsU0FBUyxzQkFBc0IsQ0FDN0IsSUFBWSxFQUNaLFNBQWlCLEVBQ2pCLFFBQTRCLEVBQzVCLEtBQVksRUFDWixNQUE2QjtJQUU3QixNQUFNLE9BQU8sR0FBRyxJQUFJLHlCQUFXLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDdkMsTUFBTSxLQUFLLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUNuQyxJQUFJLFFBQVEsRUFBRSxDQUFDO1FBQ2IsT0FBTyxDQUFDLE1BQU0sQ0FBQyxhQUFhLFFBQVEsS0FBSyxTQUFTLElBQUksS0FBSyxTQUFTLENBQUMsQ0FBQTtJQUN2RSxDQUFDO1NBQU0sQ0FBQztRQUNOLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxTQUFTLElBQUksS0FBSyxTQUFTLENBQUMsQ0FBQTtJQUMzRCxDQUFDO0lBQ0QsT0FBTyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQTtBQUN4QyxDQUFDO0FBRUQsU0FBUyxvQkFBb0IsQ0FDM0IsT0FBZSxFQUNmLEtBQVksRUFDWixNQUE2QjtJQUU3QixPQUFPLElBQUkseUJBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQTtBQUN4RSxDQUFDIn0=