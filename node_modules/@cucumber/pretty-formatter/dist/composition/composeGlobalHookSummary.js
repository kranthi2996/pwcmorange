"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.composeGlobalHookSummary = composeGlobalHookSummary;
const messages_1 = require("@cucumber/messages");
const formatting_1 = require("../formatting");
const utils_1 = require("../utils");
function composeGlobalHookSummary(testRunHookFinished, query, { theme }, stream) {
    const hook = query.findHookBy(testRunHookFinished);
    const status = testRunHookFinished.result.status;
    const lines = [];
    lines.push((0, utils_1.join)((0, formatting_1.formatHookTitle)(hook, status, {}, stream), hook?.sourceReference ? (0, formatting_1.formatSourceReference)(hook.sourceReference, theme, stream) : undefined));
    if (status === messages_1.TestStepResultStatus.FAILED) {
        const error = testRunHookFinished.result.exception?.stackTrace ||
            testRunHookFinished.result.exception?.message ||
            testRunHookFinished.result.message;
        if (error) {
            lines.push((0, utils_1.indent)((0, formatting_1.formatError)(error, status, theme, stream), utils_1.GHERKIN_INDENT_LENGTH));
        }
    }
    return lines.join('\n');
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9zZUdsb2JhbEhvb2tTdW1tYXJ5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbXBvc2l0aW9uL2NvbXBvc2VHbG9iYWxIb29rU3VtbWFyeS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQU9BLDREQTZCQztBQXBDRCxpREFBOEU7QUFHOUUsOENBQW1GO0FBRW5GLG9DQUE4RDtBQUU5RCxTQUFnQix3QkFBd0IsQ0FDdEMsbUJBQXdDLEVBQ3hDLEtBQVksRUFDWixFQUFFLEtBQUssRUFBNEIsRUFDbkMsTUFBNkI7SUFFN0IsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFBO0lBQ2xELE1BQU0sTUFBTSxHQUFHLG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUE7SUFFaEQsTUFBTSxLQUFLLEdBQWEsRUFBRSxDQUFBO0lBRTFCLEtBQUssQ0FBQyxJQUFJLENBQ1IsSUFBQSxZQUFJLEVBQ0YsSUFBQSw0QkFBZSxFQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLE1BQU0sQ0FBQyxFQUN6QyxJQUFJLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxJQUFBLGtDQUFxQixFQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQy9GLENBQ0YsQ0FBQTtJQUVELElBQUksTUFBTSxLQUFLLCtCQUFvQixDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQzNDLE1BQU0sS0FBSyxHQUNULG1CQUFtQixDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsVUFBVTtZQUNoRCxtQkFBbUIsQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLE9BQU87WUFDN0MsbUJBQW1CLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQTtRQUNwQyxJQUFJLEtBQUssRUFBRSxDQUFDO1lBQ1YsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFBLGNBQU0sRUFBQyxJQUFBLHdCQUFXLEVBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUUsNkJBQXFCLENBQUMsQ0FBQyxDQUFBO1FBQ3RGLENBQUM7SUFDSCxDQUFDO0lBRUQsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQ3pCLENBQUMifQ==